<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600">
  <defs>
    <style>
      .start { fill: #e1bee7; stroke: #8e24aa; stroke-width: 2; rx: 15; }
      .decision { fill: #fff9c4; stroke: #fbc02d; stroke-width: 2; rx: 5; }
      .action { fill: #e3f2fd; stroke: #1565c0; stroke-width: 2; rx: 5; }
      .result { fill: #c8e6c9; stroke: #2e7d32; stroke-width: 2; rx: 5; }
      .arrow { stroke: #333; stroke-width: 2; marker-end: url(#arrowhead); }
      .text { font-family: Arial, sans-serif; font-size: 12px; text-anchor: middle; }
      .label { font-size: 10px; fill: #555; background-color: white; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333"/>
    </marker>
  </defs>

  <!-- Level 1 -->
  <rect x="300" y="20" width="200" height="40" class="start"/>
  <text x="400" y="45" class="text">Start: Scaling LLMs</text>

  <line x1="400" y1="60" x2="400" y2="100" class="arrow"/>

  <!-- Level 2 -->
  <rect x="300" y="100" width="200" height="40" class="decision"/>
  <text x="400" y="125" class="text">Fits on 1 GPU?</text>

  <!-- Yes -> Standard -->
  <line x1="300" y1="120" x2="150" y2="120" class="arrow"/>
  <line x1="150" y1="120" x2="150" y2="160" class="arrow"/>
  <rect x="50" y="160" width="200" height="40" class="result"/>
  <text x="150" y="185" class="text">Standard Training (No Parallelism)</text>
  <text x="225" y="115" class="label">Yes</text>

  <!-- No -> Multi GPU? -->
  <line x1="500" y1="120" x2="650" y2="120" class="arrow"/>
  <line x1="650" y1="120" x2="650" y2="160" class="arrow"/>
  <rect x="550" y="160" width="200" height="40" class="decision"/>
  <text x="650" y="185" class="text">Multiple GPUs in 1 Node?</text>
  <text x="525" y="115" class="label">No</text>

  <!-- Level 3 -->
  <!-- No -> Cluster -->
  <line x1="750" y1="180" x2="780" y2="180" class="arrow"/>
  <line x1="780" y1="180" x2="780" y2="240" class="arrow"/>
  <rect x="700" y="240" width="90" height="40" class="result"/>
  <text x="745" y="265" class="text" font-size="10">Need Cluster</text>
  <text x="765" y="175" class="label">No</text>

  <!-- Yes -> FSDP -->
  <line x1="550" y1="180" x2="400" y2="180" class="arrow"/>
  <line x1="400" y1="180" x2="400" y2="220" class="arrow"/>
  <rect x="300" y="220" width="200" height="40" class="action"/>
  <text x="400" y="245" class="text">Start with FSDP</text>
  <text x="475" y="175" class="label">Yes</text>

  <!-- Level 4 -->
  <line x1="400" y1="260" x2="400" y2="300" class="arrow"/>
  <rect x="300" y="300" width="200" height="40" class="decision"/>
  <text x="400" y="325" class="text">Is FSDP Enough?</text>

  <!-- Yes -> Done -->
  <line x1="300" y1="320" x2="150" y2="320" class="arrow"/>
  <line x1="150" y1="320" x2="150" y2="360" class="arrow"/>
  <rect x="50" y="360" width="200" height="40" class="result"/>
  <text x="150" y="385" class="text">Use Pure FSDP</text>
  <text x="225" y="315" class="label">Yes</text>

  <!-- No -> Specific Issues -->
  <line x1="500" y1="320" x2="600" y2="320" class="arrow"/>
  <line x1="600" y1="320" x2="600" y2="360" class="arrow"/>

  <!-- Branch for TP -->
  <line x1="600" y1="340" x2="500" y2="340" class="arrow"/>
  <line x1="500" y1="340" x2="500" y2="400" class="arrow"/>
  <rect x="400" y="400" width="200" height="40" class="result"/>
  <text x="500" y="425" class="text">Add Tensor Parallel (TP)</text>
  <text x="530" y="335" class="label" font-size="9">Layers too big</text>

  <!-- Branch for CP -->
  <line x1="600" y1="340" x2="700" y2="340" class="arrow"/>
  <line x1="700" y1="340" x2="700" y2="400" class="arrow"/>
  <rect x="600" y="400" width="180" height="40" class="result"/>
  <text x="690" y="425" class="text">Add Context Parallel (CP)</text>
  <text x="630" y="335" class="label" font-size="9">Context too long</text>

  <!-- Multi-node path -->
  <line x1="400" y1="440" x2="400" y2="480" class="arrow"/>
  <rect x="300" y="480" width="200" height="40" class="decision"/>
  <text x="400" y="505" class="text">Multi-Node / Massive?</text>

  <line x1="400" y1="520" x2="400" y2="550" class="arrow"/>
  <rect x="300" y="550" width="200" height="40" class="result"/>
  <text x="400" y="575" class="text">Combine (TP + PP + FSDP)</text>

</svg>
