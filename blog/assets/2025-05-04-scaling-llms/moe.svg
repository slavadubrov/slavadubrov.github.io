<?xml version='1.0' encoding='utf-8'?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 400">
  <defs>
    <style>
      .box { fill: #f8f9fa; stroke: #333; stroke-width: 2; rx: 5; }
      .router { fill: #ffcc80; stroke: #ef6c00; stroke-width: 2; rx: 50; }
      .expert { fill: #b2dfdb; stroke: #00897b; stroke-width: 2; rx: 5; }
      .active-expert { fill: #80cbc4; stroke: #004d40; stroke-width: 3; rx: 5; }
      .arrow { stroke: #333; stroke-width: 2; marker-end: url(#arrowhead); }
      .active-arrow { stroke: #004d40; stroke-width: 3; marker-end: url(#active-arrowhead); }
      .text { font-family: Arial, sans-serif; font-size: 14px; text-anchor: middle; }
      .title { font-family: Arial, sans-serif; font-size: 18px; font-weight: bold; text-anchor: middle; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
    </marker>
    <marker id="active-arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#004d40" />
    </marker>
  </defs>

  <rect width="100%" height="100%" fill="white" />
  <text x="400" y="30" class="title">Mixture of Experts (MoE)</text>


  <rect x="350" y="60" width="100" height="40" class="box" />
  <text x="400" y="85" class="text">Input Token</text>

  <line x1="400" y1="100" x2="400" y2="140" class="arrow" marker-end="url(#arrowhead)" />


  <circle cx="400" cy="170" r="30" class="router" />
  <text x="400" y="175" class="text" font-size="12">Router</text>



  <rect x="100" y="250" width="120" height="60" class="expert" />
  <text x="160" y="285" class="text">Expert 1</text>
  <line x1="380" y1="190" x2="160" y2="250" class="arrow" stroke-dasharray="5,5" marker-end="url(#arrowhead)" />


  <rect x="250" y="250" width="120" height="60" class="active-expert" />
  <text x="310" y="285" class="text" font-weight="bold">Expert 2</text>
  <line x1="390" y1="195" x2="310" y2="250" class="active-arrow" marker-end="url(#arrowhead)" />


  <rect x="430" y="250" width="120" height="60" class="expert" />
  <text x="490" y="285" class="text">Expert 3</text>
  <line x1="410" y1="195" x2="490" y2="250" class="arrow" stroke-dasharray="5,5" marker-end="url(#arrowhead)" />


  <rect x="580" y="250" width="120" height="60" class="active-expert" />
  <text x="640" y="285" class="text" font-weight="bold">Expert 4</text>
  <line x1="420" y1="190" x2="640" y2="250" class="active-arrow" marker-end="url(#arrowhead)" />


  <line x1="310" y1="310" x2="380" y2="350" class="active-arrow" marker-end="url(#arrowhead)" />
  <line x1="640" y1="310" x2="420" y2="350" class="active-arrow" marker-end="url(#arrowhead)" />

  <rect x="350" y="350" width="100" height="40" class="box" />
  <text x="400" y="375" class="text">Combined Output</text>

  <text x="150" y="380" class="text" font-size="12" fill="#004d40">Only selected experts activate</text>
</svg>
