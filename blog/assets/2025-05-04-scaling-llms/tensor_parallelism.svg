<?xml version='1.0' encoding='utf-8'?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 400">
  <defs>
    <style>
      .gpu { fill: #e3f2fd; stroke: #1565c0; stroke-width: 2; rx: 5; }
      .matrix { fill: #fff9c4; stroke: #fbc02d; stroke-width: 1; rx: 2; }
      .input { fill: #c8e6c9; stroke: #2e7d32; stroke-width: 1; rx: 2; }
      .output { fill: #f8bbd0; stroke: #c2185b; stroke-width: 1; rx: 2; }
      .arrow { stroke: #333; stroke-width: 2; marker-end: url(#arrowhead); }
      .text { font-family: Arial, sans-serif; font-size: 14px; text-anchor: middle; }
      .title { font-family: Arial, sans-serif; font-size: 18px; font-weight: bold; text-anchor: middle; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
    </marker>
  </defs>

  <rect width="100%" height="100%" fill="white" />
  <text x="400" y="30" class="title">Tensor Parallelism (TP)</text>


  <rect x="350" y="60" width="100" height="40" class="input" />
  <text x="400" y="85" class="text">Input X</text>


  <line x1="400" y1="100" x2="200" y2="140" class="arrow" marker-end="url(#arrowhead)" />
  <line x1="400" y1="100" x2="600" y2="140" class="arrow" marker-end="url(#arrowhead)" />


  <rect x="100" y="140" width="200" height="150" class="gpu" />
  <text x="200" y="165" class="text" font-weight="bold">GPU 1</text>
  <rect x="120" y="180" width="160" height="60" class="matrix" />
  <text x="200" y="215" class="text">Weight Chunk A</text>
  <rect x="120" y="250" width="160" height="30" class="output" />
  <text x="200" y="270" class="text">Partial Output Y1</text>


  <rect x="500" y="140" width="200" height="150" class="gpu" />
  <text x="600" y="165" class="text" font-weight="bold">GPU 2</text>
  <rect x="520" y="180" width="160" height="60" class="matrix" />
  <text x="600" y="215" class="text">Weight Chunk B</text>
  <rect x="520" y="250" width="160" height="30" class="output" />
  <text x="600" y="270" class="text">Partial Output Y2</text>


  <line x1="200" y1="290" x2="350" y2="340" class="arrow" marker-end="url(#arrowhead)" />
  <line x1="600" y1="290" x2="450" y2="340" class="arrow" marker-end="url(#arrowhead)" />

  <rect x="300" y="340" width="200" height="60" class="output" />
  <text x="400" y="365" class="text">Combined Output Y</text>
  <text x="400" y="385" class="text" font-size="12" fill="#666">(All-Reduce / Concat)</text>
</svg>
