<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 980 640" font-family="'Segoe UI', system-ui, -apple-system, sans-serif">
  <defs>
    <marker id="arwG" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#888"/>
    </marker>
    <marker id="arwB" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#1565c0"/>
    </marker>
    <marker id="arwO" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#e65100"/>
    </marker>
    <marker id="arwGn" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#2e7d32"/>
    </marker>
    <filter id="sh" x="-2%" y="-2%" width="104%" height="108%">
      <feDropShadow dx="1" dy="2" stdDeviation="2" flood-opacity="0.12"/>
    </filter>
  </defs>

  <!-- Title -->
  <text x="490" y="28" text-anchor="middle" font-size="20" font-weight="700" fill="#1a1a2e">Complete Agent Memory Architecture</text>
  <text x="490" y="48" text-anchor="middle" font-size="12" fill="#666">Three-Tier Memory: Hot (Checkpoints) + Cold (Vector/KV) + Document (Files)</text>

  <!-- ======= USER (top center) ======= -->
  <rect x="420" y="62" width="140" height="34" rx="17" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1.5" filter="url(#sh)"/>
  <text x="490" y="84" text-anchor="middle" font-size="12" font-weight="600" fill="#2e7d32">User</text>

  <!-- User <-> Agent arrows -->
  <line x1="478" y1="96" x2="478" y2="118" stroke="#2e7d32" stroke-width="2" marker-end="url(#arwGn)"/>
  <text x="464" y="112" font-size="9" font-weight="600" fill="#2e7d32">request</text>
  <line x1="502" y1="118" x2="502" y2="96" stroke="#2e7d32" stroke-width="1.5" stroke-dasharray="5,3" marker-end="url(#arwGn)"/>
  <text x="514" y="112" font-size="9" font-weight="600" fill="#2e7d32">response</text>

  <!-- ======= AGENT CORE ======= -->
  <rect x="340" y="120" width="300" height="96" rx="12" fill="#f3e5f5" stroke="#6a1b9a" stroke-width="2" filter="url(#sh)"/>
  <text x="490" y="148" text-anchor="middle" font-size="16" font-weight="700" fill="#6a1b9a">LLM Agent</text>
  <text x="490" y="166" text-anchor="middle" font-size="11" fill="#888">Reasoning + Planning + Tool Use</text>
  <text x="490" y="182" text-anchor="middle" font-size="10" fill="#aaa">Think → Act → Observe loop</text>

  <!-- Working Memory badge inside agent -->
  <rect x="360" y="190" width="260" height="22" rx="6" fill="#6a1b9a" opacity="0.15"/>
  <text x="490" y="206" text-anchor="middle" font-size="10" font-weight="600" fill="#6a1b9a">Working Memory: context window (128K tokens)</text>

  <!-- ======= HOT MEMORY (left) ======= -->
  <rect x="20" y="270" width="280" height="290" rx="12" fill="#f0f7ff" stroke="#1565c0" stroke-width="1.5" stroke-dasharray="5"/>
  <text x="160" y="295" text-anchor="middle" font-size="14" font-weight="700" fill="#1565c0">Hot Memory (Short-Term)</text>
  <text x="160" y="310" text-anchor="middle" font-size="10" fill="#888">Session-scoped, fast access</text>

  <!-- PostgreSQL -->
  <rect x="40" y="325" width="240" height="65" rx="8" fill="#e3f2fd" stroke="#1565c0" stroke-width="1.5" filter="url(#sh)"/>
  <text x="160" y="348" text-anchor="middle" font-size="13" font-weight="600" fill="#1565c0">PostgreSQL</text>
  <text x="160" y="364" text-anchor="middle" font-size="10" fill="#555">Checkpoints, thread state</text>
  <text x="160" y="380" text-anchor="middle" font-size="9" fill="#aaa">ACID | JSONB | WAL durability</text>

  <!-- Redis -->
  <rect x="40" y="400" width="240" height="65" rx="8" fill="#fce4ec" stroke="#c62828" stroke-width="1.5" filter="url(#sh)"/>
  <text x="160" y="423" text-anchor="middle" font-size="13" font-weight="600" fill="#c62828">Redis</text>
  <text x="160" y="439" text-anchor="middle" font-size="10" fill="#555">Session cache, rate limits</text>
  <text x="160" y="455" text-anchor="middle" font-size="9" fill="#aaa">Sub-ms latency | TTL-based</text>

  <!-- LangGraph label -->
  <rect x="50" y="478" width="220" height="28" rx="6" fill="white" stroke="#1565c0" stroke-width="1" filter="url(#sh)"/>
  <text x="160" y="496" text-anchor="middle" font-size="10" font-weight="600" fill="#1565c0">LangGraph PostgresSaver</text>

  <!-- Hot latency badge -->
  <rect x="50" y="518" width="220" height="24" rx="12" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1"/>
  <text x="160" y="535" text-anchor="middle" font-size="10" font-weight="600" fill="#2e7d32">Latency: 1-5 ms | Retention: hours-days</text>

  <!-- ======= COLD MEMORY (center) ======= -->
  <rect x="350" y="270" width="280" height="290" rx="12" fill="#fff9f0" stroke="#e65100" stroke-width="1.5" stroke-dasharray="5"/>
  <text x="490" y="295" text-anchor="middle" font-size="14" font-weight="700" fill="#e65100">Cold Memory (Long-Term)</text>
  <text x="490" y="310" text-anchor="middle" font-size="10" fill="#888">Cross-session, searchable</text>

  <!-- Vector DB -->
  <rect x="370" y="325" width="240" height="65" rx="8" fill="#fff3e0" stroke="#e65100" stroke-width="1.5" filter="url(#sh)"/>
  <text x="490" y="348" text-anchor="middle" font-size="13" font-weight="600" fill="#e65100">Vector DB (Qdrant)</text>
  <text x="490" y="364" text-anchor="middle" font-size="10" fill="#555">Semantic search over facts</text>
  <text x="490" y="380" text-anchor="middle" font-size="9" fill="#aaa">HNSW index | Cosine similarity</text>

  <!-- Embedding Model -->
  <rect x="370" y="400" width="240" height="65" rx="8" fill="#f3e5f5" stroke="#6a1b9a" stroke-width="1.5" filter="url(#sh)"/>
  <text x="490" y="423" text-anchor="middle" font-size="13" font-weight="600" fill="#6a1b9a">Embedding Model</text>
  <text x="490" y="439" text-anchor="middle" font-size="10" fill="#555">text-embedding-3-small</text>
  <text x="490" y="455" text-anchor="middle" font-size="9" fill="#aaa">Chunk → 1536-dim vector</text>

  <!-- Knowledge sources -->
  <rect x="380" y="478" width="220" height="28" rx="6" fill="white" stroke="#e65100" stroke-width="1" filter="url(#sh)"/>
  <text x="490" y="496" text-anchor="middle" font-size="10" font-weight="600" fill="#e65100">User facts, preferences, learnings</text>

  <!-- Cold latency badge -->
  <rect x="380" y="518" width="220" height="24" rx="12" fill="#fff3e0" stroke="#e65100" stroke-width="1"/>
  <text x="490" y="535" text-anchor="middle" font-size="10" font-weight="600" fill="#e65100">Latency: 50-200 ms | Retention: months</text>

  <!-- ======= DOCUMENT MEMORY (right) ======= -->
  <rect x="680" y="270" width="280" height="290" rx="12" fill="#f5fff7" stroke="#2e7d32" stroke-width="1.5" stroke-dasharray="5"/>
  <text x="820" y="295" text-anchor="middle" font-size="14" font-weight="700" fill="#2e7d32">Document Memory</text>
  <text x="820" y="310" text-anchor="middle" font-size="10" fill="#888">File-based knowledge</text>

  <!-- Filesystem -->
  <rect x="700" y="325" width="240" height="65" rx="8" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1.5" filter="url(#sh)"/>
  <text x="820" y="348" text-anchor="middle" font-size="13" font-weight="600" fill="#2e7d32">Filesystem</text>
  <text x="820" y="364" text-anchor="middle" font-size="10" fill="#555">Markdown/JSON files</text>
  <text x="820" y="380" text-anchor="middle" font-size="9" fill="#aaa">Direct read/write | Git-native</text>

  <!-- Folder Structure -->
  <rect x="700" y="400" width="240" height="65" rx="8" fill="#f1f8f1" stroke="#27ae60" stroke-width="1.5" filter="url(#sh)"/>
  <text x="820" y="423" text-anchor="middle" font-size="13" font-weight="600" fill="#2e7d32">Folder Structure</text>
  <text x="820" y="439" text-anchor="middle" font-size="10" fill="#555">.agent-memory/ directory</text>
  <text x="820" y="455" text-anchor="middle" font-size="9" fill="#aaa">Conventions, research, notes</text>

  <!-- Document types -->
  <rect x="710" y="478" width="220" height="28" rx="6" fill="white" stroke="#2e7d32" stroke-width="1" filter="url(#sh)"/>
  <text x="820" y="496" text-anchor="middle" font-size="10" font-weight="600" fill="#2e7d32">Project knowledge, human-editable</text>

  <!-- Document latency badge -->
  <rect x="710" y="518" width="220" height="24" rx="12" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1"/>
  <text x="820" y="535" text-anchor="middle" font-size="10" font-weight="600" fill="#2e7d32">Latency: 1-5 ms | Retention: days-forever</text>

  <!-- ======= ARROWS: Agent <-> Hot Memory ======= -->
  <!-- checkpoint: Agent left-bottom -> Hot Memory top -->
  <path d="M370,212 Q280,244 200,270" stroke="#1565c0" stroke-width="2" fill="none" marker-end="url(#arwB)"/>
  <text x="268" y="234" font-size="9" font-weight="600" fill="#1565c0">checkpoint</text>

  <!-- restore: Hot Memory top -> Agent left side -->
  <path d="M120,270 Q200,244 340,170" stroke="#1565c0" stroke-width="2" fill="none" stroke-dasharray="5,3" marker-end="url(#arwB)"/>
  <text x="190" y="250" font-size="9" font-weight="600" fill="#1565c0">restore</text>

  <!-- ======= ARROWS: Agent <-> Cold Memory ======= -->
  <!-- query: Agent bottom -> Cold Memory top -->
  <line x1="470" y1="216" x2="470" y2="270" stroke="#e65100" stroke-width="2" marker-end="url(#arwO)"/>
  <text x="456" y="248" font-size="9" font-weight="600" fill="#e65100" text-anchor="end">query</text>

  <!-- context: Cold Memory top -> Agent bottom -->
  <line x1="510" y1="270" x2="510" y2="216" stroke="#e65100" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arwO)"/>
  <text x="524" y="248" font-size="9" font-weight="600" fill="#e65100">context</text>

  <!-- ======= ARROWS: Agent <-> Document Memory ======= -->
  <!-- read docs: Agent right-bottom -> Document Memory top -->
  <path d="M610,212 Q700,244 780,270" stroke="#2e7d32" stroke-width="2" fill="none" marker-end="url(#arwGn)"/>
  <text x="718" y="234" font-size="9" font-weight="600" fill="#2e7d32">read docs</text>

  <!-- write notes: Document Memory top -> Agent right side -->
  <path d="M860,270 Q780,244 640,170" stroke="#2e7d32" stroke-width="2" fill="none" stroke-dasharray="5,3" marker-end="url(#arwGn)"/>
  <text x="790" y="250" font-size="9" font-weight="600" fill="#2e7d32">write notes</text>

  <!-- ======= ARROW: Hot -> Cold (promote facts) ======= -->
  <line x1="300" y1="430" x2="350" y2="430" stroke="#888" stroke-width="1.2" stroke-dasharray="4,3" marker-end="url(#arwG)"/>
  <text x="325" y="422" text-anchor="middle" font-size="9" fill="#888">promote facts</text>

  <!-- ======= ARROW: User -> Document Memory (edit files) ======= -->
  <path d="M560,79 L950,79 L950,270" stroke="#888" stroke-width="1.2" stroke-dasharray="4,3" fill="none" marker-end="url(#arwG)"/>
  <text x="750" y="72" font-size="9" fill="#888">edit files directly</text>

  <!-- ======= Legend ======= -->
  <rect x="20" y="578" width="940" height="40" rx="6" fill="#f5f5f5" stroke="#ddd" stroke-width="1"/>
  <line x1="35" y1="593" x2="65" y2="593" stroke="#555" stroke-width="1.5"/>
  <text x="72" y="597" font-size="9" fill="#555">Write / request</text>
  <line x1="155" y1="593" x2="185" y2="593" stroke="#555" stroke-width="1.5" stroke-dasharray="5,3"/>
  <text x="192" y="597" font-size="9" fill="#555">Read / response</text>

  <text x="300" y="597" font-size="9" fill="#888">Colors:</text>
  <rect x="340" y="586" width="50" height="14" rx="3" fill="#e3f2fd" stroke="#1565c0" stroke-width="1"/>
  <text x="397" y="597" font-size="9" fill="#555">Hot</text>
  <rect x="420" y="586" width="50" height="14" rx="3" fill="#fff3e0" stroke="#e65100" stroke-width="1"/>
  <text x="477" y="597" font-size="9" fill="#555">Cold</text>
  <rect x="500" y="586" width="55" height="14" rx="3" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1"/>
  <text x="562" y="597" font-size="9" fill="#555">Document</text>
  <rect x="600" y="586" width="55" height="14" rx="3" fill="#f3e5f5" stroke="#6a1b9a" stroke-width="1"/>
  <text x="662" y="597" font-size="9" fill="#555">Agent/LLM</text>

  <text x="35" y="610" font-size="9" fill="#888">Key insight: Three complementary memory tiers — checkpoints for durability, vectors for semantic recall, files for transparency</text>
</svg>
