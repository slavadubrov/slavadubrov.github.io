<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 780 420" font-family="'Segoe UI', system-ui, -apple-system, sans-serif">
  <defs>
    <marker id="arrowH" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#555"/>
    </marker>
    <filter id="shadowH" x="-2%" y="-2%" width="104%" height="108%">
      <feDropShadow dx="1" dy="2" stdDeviation="2" flood-opacity="0.1"/>
    </filter>
  </defs>

  <!-- Title -->
  <text x="390" y="30" text-anchor="middle" font-size="18" font-weight="700" fill="#1a1a2e">Hybrid Search with Reciprocal Rank Fusion</text>

  <!-- Query -->
  <rect x="310" y="50" width="160" height="40" rx="20" fill="#f3e5f5" stroke="#6a1b9a" stroke-width="1.5" filter="url(#shadowH)"/>
  <text x="390" y="75" text-anchor="middle" font-size="13" font-weight="600" fill="#6a1b9a">User Query</text>

  <!-- Arrows from query -->
  <line x1="345" y1="90" x2="180" y2="130" stroke="#555" stroke-width="1.5" marker-end="url(#arrowH)"/>
  <line x1="435" y1="90" x2="600" y2="130" stroke="#555" stroke-width="1.5" marker-end="url(#arrowH)"/>

  <!-- BM25 Sparse Index -->
  <rect x="60" y="133" width="240" height="110" rx="8" fill="#fff3e0" stroke="#e65100" stroke-width="1.5" filter="url(#shadowH)"/>
  <text x="180" y="157" text-anchor="middle" font-size="12" font-weight="700" fill="#e65100">Sparse Index (BM25)</text>
  <text x="180" y="177" text-anchor="middle" font-size="11" fill="#555">Inverted Index Lookup</text>

  <text x="85" y="198" font-size="11" fill="#333">1. Doc-X</text>
  <text x="175" y="198" font-size="10" fill="#999">score: 12.5</text>
  <text x="85" y="215" font-size="11" fill="#333">2. Doc-Y</text>
  <text x="175" y="215" font-size="10" fill="#999">score: 8.3</text>
  <text x="85" y="232" font-size="11" fill="#333">3. Doc-Z</text>
  <text x="175" y="232" font-size="10" fill="#999">score: 7.1</text>

  <!-- Dense Index -->
  <rect x="480" y="133" width="240" height="110" rx="8" fill="#e3f2fd" stroke="#1565c0" stroke-width="1.5" filter="url(#shadowH)"/>
  <text x="600" y="157" text-anchor="middle" font-size="12" font-weight="700" fill="#1565c0">Dense Index (HNSW)</text>
  <text x="600" y="177" text-anchor="middle" font-size="11" fill="#555">ANN Vector Search</text>

  <text x="505" y="198" font-size="11" fill="#333">1. Doc-Y</text>
  <text x="595" y="198" font-size="10" fill="#999">sim: 0.92</text>
  <text x="505" y="215" font-size="11" fill="#333">2. Doc-X</text>
  <text x="595" y="215" font-size="10" fill="#999">sim: 0.87</text>
  <text x="505" y="232" font-size="11" fill="#333">3. Doc-W</text>
  <text x="595" y="232" font-size="10" fill="#999">sim: 0.81</text>

  <!-- Arrows to RRF -->
  <line x1="180" y1="243" x2="320" y2="290" stroke="#555" stroke-width="1.5" marker-end="url(#arrowH)"/>
  <line x1="600" y1="243" x2="460" y2="290" stroke="#555" stroke-width="1.5" marker-end="url(#arrowH)"/>

  <!-- RRF Fusion Box -->
  <rect x="280" y="280" width="220" height="55" rx="8" fill="#f3e5f5" stroke="#6a1b9a" stroke-width="2" filter="url(#shadowH)"/>
  <text x="390" y="303" text-anchor="middle" font-size="13" font-weight="700" fill="#6a1b9a">RRF Fusion (k=60)</text>
  <text x="390" y="322" text-anchor="middle" font-size="11" fill="#555">score(d) = Sum 1/(k + rank)</text>

  <!-- Arrow to results -->
  <line x1="390" y1="335" x2="390" y2="365" stroke="#555" stroke-width="1.5" marker-end="url(#arrowH)"/>

  <!-- Fused Results -->
  <rect x="220" y="368" width="340" height="42" rx="8" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1.5" filter="url(#shadowH)"/>
  <text x="245" y="393" font-size="11" fill="#333">
    <tspan font-weight="700" fill="#2e7d32">1.</tspan> Doc-Y (0.033)
    <tspan dx="15" font-weight="700" fill="#2e7d32">2.</tspan> Doc-X (0.033)
    <tspan dx="15" font-weight="700" fill="#2e7d32">3.</tspan> Doc-Z (0.016)
  </text>

  <!-- Callout -->
  <rect x="560" y="280" width="190" height="52" rx="6" fill="#fffde7" stroke="#f9a825" stroke-width="1" stroke-dasharray="3"/>
  <text x="570" y="298" font-size="10" fill="#555">Rank-based, not score-based.</text>
  <text x="570" y="313" font-size="10" fill="#555">Immune to score-scale</text>
  <text x="570" y="328" font-size="10" fill="#555">mismatch between methods.</text>

</svg>
