<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 820 520" font-family="'Segoe UI', system-ui, -apple-system, sans-serif">
  <defs>
    <marker id="arrowCE" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#555"/>
    </marker>
    <filter id="shadowCE" x="-2%" y="-2%" width="104%" height="108%">
      <feDropShadow dx="1" dy="2" stdDeviation="2" flood-opacity="0.1"/>
    </filter>
  </defs>

  <!-- Title -->
  <text x="410" y="28" text-anchor="middle" font-size="18" font-weight="700" fill="#1a1a2e">Attention Patterns: Bi-Encoder vs. Cross-Encoder</text>
  <text x="410" y="48" text-anchor="middle" font-size="12" fill="#666">Block-diagonal (independent) vs. Full (cross-attention) attention matrices</text>

  <!-- === LEFT: Bi-Encoder Attention === -->
  <rect x="30" y="65" width="360" height="440" rx="10" fill="#f9fafb" stroke="#ddd" stroke-width="1"/>
  <text x="210" y="90" text-anchor="middle" font-size="14" font-weight="700" fill="#1565c0">Bi-Encoder</text>

  <!-- Attention matrix -->
  <rect x="80" y="105" width="100" height="100" rx="2" fill="#e3f2fd" stroke="#1565c0" stroke-width="1.5"/>
  <text x="130" y="160" text-anchor="middle" font-size="10" font-weight="700" fill="#1565c0">Q-Q</text>
  <text x="130" y="173" text-anchor="middle" font-size="8" fill="#1565c0">active</text>

  <rect x="180" y="105" width="100" height="100" rx="2" fill="#f5f5f5" stroke="#ccc" stroke-width="1"/>
  <text x="230" y="155" text-anchor="middle" font-size="18" fill="#ccc">X</text>
  <text x="230" y="173" text-anchor="middle" font-size="8" fill="#999">no interaction</text>

  <rect x="80" y="205" width="100" height="100" rx="2" fill="#f5f5f5" stroke="#ccc" stroke-width="1"/>
  <text x="130" y="255" text-anchor="middle" font-size="18" fill="#ccc">X</text>
  <text x="130" y="273" text-anchor="middle" font-size="8" fill="#999">no interaction</text>

  <rect x="180" y="205" width="100" height="100" rx="2" fill="#fff3e0" stroke="#e65100" stroke-width="1.5"/>
  <text x="230" y="260" text-anchor="middle" font-size="10" font-weight="700" fill="#e65100">D-D</text>
  <text x="230" y="273" text-anchor="middle" font-size="8" fill="#e65100">active</text>

  <!-- Matrix labels -->
  <text x="130" y="100" text-anchor="middle" font-size="9" fill="#1565c0">Query tokens</text>
  <text x="230" y="100" text-anchor="middle" font-size="9" fill="#e65100">Doc tokens</text>
  <text x="72" y="160" text-anchor="middle" font-size="9" fill="#1565c0" transform="rotate(-90, 72, 160)">Query</text>
  <text x="72" y="260" text-anchor="middle" font-size="9" fill="#e65100" transform="rotate(-90, 72, 260)">Doc</text>

  <!-- Arrow down -->
  <line x1="180" y1="310" x2="180" y2="348" stroke="#555" stroke-width="1.2" marker-end="url(#arrowCE)"/>

  <!-- Bi-Encoder output path -->
  <rect x="80" y="350" width="100" height="30" rx="6" fill="#e8eaf6" stroke="#3949ab" stroke-width="1" filter="url(#shadowCE)"/>
  <text x="130" y="370" text-anchor="middle" font-size="10" font-weight="600" fill="#3949ab">q embed</text>

  <rect x="200" y="350" width="100" height="30" rx="6" fill="#fff8e1" stroke="#f57f17" stroke-width="1" filter="url(#shadowCE)"/>
  <text x="250" y="370" text-anchor="middle" font-size="10" font-weight="600" fill="#e65100">d embed</text>

  <!-- Arrow to dot product -->
  <line x1="155" y1="380" x2="175" y2="410" stroke="#555" stroke-width="1.2" marker-end="url(#arrowCE)"/>
  <line x1="225" y1="380" x2="205" y2="410" stroke="#555" stroke-width="1.2" marker-end="url(#arrowCE)"/>

  <rect x="150" y="413" width="90" height="30" rx="6" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1.2" filter="url(#shadowCE)"/>
  <text x="195" y="433" text-anchor="middle" font-size="10" font-weight="600" fill="#2e7d32">dot product</text>

  <line x1="195" y1="443" x2="195" y2="468" stroke="#555" stroke-width="1.2" marker-end="url(#arrowCE)"/>
  <text x="195" y="485" text-anchor="middle" font-size="11" font-weight="600" fill="#2e7d32">0.87</text>
  <text x="195" y="498" text-anchor="middle" font-size="9" fill="#888">similarity score</text>

  <!-- === RIGHT: Cross-Encoder Attention === -->
  <rect x="430" y="65" width="360" height="440" rx="10" fill="#f9fafb" stroke="#ddd" stroke-width="1"/>
  <text x="610" y="90" text-anchor="middle" font-size="14" font-weight="700" fill="#c62828">Cross-Encoder</text>

  <!-- Full attention matrix -->
  <rect x="480" y="105" width="100" height="100" rx="2" fill="#e3f2fd" stroke="#1565c0" stroke-width="1.5"/>
  <text x="530" y="160" text-anchor="middle" font-size="10" font-weight="700" fill="#1565c0">Q-Q</text>
  <text x="530" y="173" text-anchor="middle" font-size="8" fill="#1565c0">active</text>

  <rect x="580" y="105" width="100" height="100" rx="2" fill="#fce4ec" stroke="#c62828" stroke-width="2"/>
  <text x="630" y="155" text-anchor="middle" font-size="10" font-weight="700" fill="#c62828">Q-D</text>
  <text x="630" y="173" text-anchor="middle" font-size="8" fill="#c62828">cross-attention</text>

  <rect x="480" y="205" width="100" height="100" rx="2" fill="#fce4ec" stroke="#c62828" stroke-width="2"/>
  <text x="530" y="255" text-anchor="middle" font-size="10" font-weight="700" fill="#c62828">D-Q</text>
  <text x="530" y="273" text-anchor="middle" font-size="8" fill="#c62828">cross-attention</text>

  <rect x="580" y="205" width="100" height="100" rx="2" fill="#fff3e0" stroke="#e65100" stroke-width="1.5"/>
  <text x="630" y="260" text-anchor="middle" font-size="10" font-weight="700" fill="#e65100">D-D</text>
  <text x="630" y="273" text-anchor="middle" font-size="8" fill="#e65100">active</text>

  <!-- Matrix labels -->
  <text x="530" y="100" text-anchor="middle" font-size="9" fill="#1565c0">Query tokens</text>
  <text x="630" y="100" text-anchor="middle" font-size="9" fill="#e65100">Doc tokens</text>
  <text x="472" y="160" text-anchor="middle" font-size="9" fill="#1565c0" transform="rotate(-90, 472, 160)">Query</text>
  <text x="472" y="260" text-anchor="middle" font-size="9" fill="#e65100" transform="rotate(-90, 472, 260)">Doc</text>

  <!-- Arrow down -->
  <line x1="580" y1="310" x2="580" y2="348" stroke="#555" stroke-width="1.2" marker-end="url(#arrowCE)"/>

  <!-- Cross-Encoder output path -->
  <rect x="520" y="350" width="120" height="30" rx="6" fill="#ffcdd2" stroke="#c62828" stroke-width="1" filter="url(#shadowCE)"/>
  <text x="580" y="370" text-anchor="middle" font-size="10" font-weight="600" fill="#c62828">[CLS] hidden state</text>

  <!-- Arrow to classification head -->
  <line x1="580" y1="380" x2="580" y2="410" stroke="#555" stroke-width="1.2" marker-end="url(#arrowCE)"/>

  <rect x="520" y="413" width="120" height="30" rx="6" fill="#fff3e0" stroke="#e65100" stroke-width="1.2" filter="url(#shadowCE)"/>
  <text x="580" y="433" text-anchor="middle" font-size="10" font-weight="600" fill="#e65100">Linear + Sigmoid</text>

  <line x1="580" y1="443" x2="580" y2="468" stroke="#555" stroke-width="1.2" marker-end="url(#arrowCE)"/>
  <text x="580" y="485" text-anchor="middle" font-size="11" font-weight="600" fill="#2e7d32">0.94</text>
  <text x="580" y="498" text-anchor="middle" font-size="9" fill="#888">relevance score</text>

  <!-- Highlight box on cross-attention -->
  <rect x="475" y="100" width="210" height="210" rx="4" fill="none" stroke="#c62828" stroke-width="2" stroke-dasharray="5,3"/>

</svg>
