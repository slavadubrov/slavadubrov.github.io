<svg viewBox="0 0 800 400" xmlns="http://www.w3.org/2000/svg" font-family="system-ui, -apple-system, sans-serif">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#374151"/>
    </marker>
    <linearGradient id="routerGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f59e0b"/>
      <stop offset="100%" style="stop-color:#d97706"/>
    </linearGradient>
    <linearGradient id="plannerGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#3b82f6"/>
      <stop offset="100%" style="stop-color:#1d4ed8"/>
    </linearGradient>
    <linearGradient id="executorGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#10b981"/>
      <stop offset="100%" style="stop-color:#059669"/>
    </linearGradient>
    <linearGradient id="reporterGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#8b5cf6"/>
      <stop offset="100%" style="stop-color:#6d28d9"/>
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="800" height="400" fill="#fafafa"/>

  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" font-size="18" font-weight="bold" fill="#111827">Market Analyst Agent: Plan-and-Execute Architecture</text>

  <!-- START -->
  <circle cx="60" cy="200" r="25" fill="#6b7280"/>
  <text x="60" y="205" text-anchor="middle" font-size="11" fill="white" font-weight="bold">START</text>

  <!-- Router - Diamond shape with icon -->
  <line x1="85" y1="200" x2="125" y2="200" stroke="#374151" stroke-width="2" marker-end="url(#arrow)"/>
  <g transform="translate(175, 200)">
    <!-- Diamond shape -->
    <polygon points="0,-40 50,0 0,40 -50,0" fill="url(#routerGrad)" stroke="#d97706" stroke-width="1"/>
    <!-- Router icon - branching arrows -->
    <path d="M-15,-8 L0,-8 L0,-18 M0,-8 L15,8 M0,-8 L-15,8" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
  </g>
  <text x="175" y="255" text-anchor="middle" font-size="11" fill="#92400e" font-weight="bold">Router</text>

  <!-- Deep Research Path (Top) -->
  <g>
    <path d="M 210 168 L 280 120" stroke="#374151" stroke-width="2" marker-end="url(#arrow)"/>
    <!-- Deep label - moved to the left of the arrow path, made more visible -->
    <rect x="232" y="128" width="40" height="18" rx="4" fill="#3b82f6"/>
    <text x="252" y="141" text-anchor="middle" font-size="10" fill="white" font-weight="bold">Deep</text>

    <!-- Planner -->
    <rect x="290" y="85" width="100" height="40" rx="8" fill="url(#plannerGrad)"/>
    <text x="340" y="110" text-anchor="middle" font-size="12" fill="white" font-weight="bold">Planner</text>

    <line x1="390" y1="105" x2="440" y2="105" stroke="#374151" stroke-width="2" marker-end="url(#arrow)"/>

    <!-- Executor Box -->
    <rect x="450" y="60" width="150" height="90" rx="8" fill="#d1fae5" stroke="#10b981" stroke-width="2"/>
    <text x="525" y="82" text-anchor="middle" font-size="12" fill="#047857" font-weight="bold">Executor</text>
    <text x="525" y="96" text-anchor="middle" font-size="9" fill="#6b7280">(ReAct Agent)</text>

    <!-- Tools inside Executor -->
    <rect x="465" y="105" width="55" height="20" rx="4" fill="url(#executorGrad)"/>
    <text x="492" y="119" text-anchor="middle" font-size="8" fill="white">Tool Call</text>
    <rect x="530" y="105" width="55" height="20" rx="4" fill="url(#executorGrad)"/>
    <text x="557" y="119" text-anchor="middle" font-size="8" fill="white">Observe</text>

    <!-- Loop arrow on Executor -->
    <path d="M 580 135 Q 620 135 620 100 Q 620 70 580 70" fill="none" stroke="#10b981" stroke-width="1.5" stroke-dasharray="4,2" marker-end="url(#arrow)"/>
    <text x="635" y="105" font-size="9" fill="#10b981">Loop</text>

    <line x1="600" y1="105" x2="660" y2="200" stroke="#374151" stroke-width="2" marker-end="url(#arrow)"/>
  </g>

  <!-- Flash Briefing Path (Bottom) - ReWOO -->
  <g>
    <path d="M 210 232 L 280 280" stroke="#374151" stroke-width="2" marker-end="url(#arrow)"/>
    <!-- Flash label - moved to the left of the arrow path, made more visible -->
    <rect x="232" y="252" width="42" height="18" rx="4" fill="#8b5cf6"/>
    <text x="253" y="265" text-anchor="middle" font-size="10" fill="white" font-weight="bold">Flash</text>

    <!-- ReWOO Planner -->
    <rect x="290" y="260" width="100" height="40" rx="8" fill="#ddd6fe" stroke="#8b5cf6" stroke-width="2"/>
    <text x="340" y="278" text-anchor="middle" font-size="10" fill="#5b21b6" font-weight="bold">ReWOO</text>
    <text x="340" y="292" text-anchor="middle" font-size="10" fill="#5b21b6" font-weight="bold">Planner</text>

    <line x1="390" y1="280" x2="435" y2="280" stroke="#374151" stroke-width="2" marker-end="url(#arrow)"/>

    <!-- Worker (Parallel Execution) -->
    <rect x="445" y="255" width="100" height="50" rx="8" fill="#ddd6fe" stroke="#8b5cf6" stroke-width="2"/>
    <text x="495" y="278" text-anchor="middle" font-size="10" fill="#5b21b6" font-weight="bold">Worker</text>
    <text x="495" y="293" text-anchor="middle" font-size="9" fill="#6b7280">âš¡ Parallel</text>

    <line x1="545" y1="280" x2="585" y2="280" stroke="#374151" stroke-width="2" marker-end="url(#arrow)"/>

    <!-- Solver -->
    <rect x="595" y="260" width="80" height="40" rx="8" fill="#ddd6fe" stroke="#8b5cf6" stroke-width="2"/>
    <text x="635" y="285" text-anchor="middle" font-size="10" fill="#5b21b6" font-weight="bold">Solver</text>

    <path d="M 635 260 L 680 220" stroke="#374151" stroke-width="2" marker-end="url(#arrow)"/>
  </g>

  <!-- Reporter -->
  <rect x="680" y="175" width="80" height="50" rx="8" fill="url(#reporterGrad)"/>
  <text x="720" y="205" text-anchor="middle" font-size="11" fill="white" font-weight="bold">Reporter</text>

  <!-- Legend -->
  <g transform="translate(30, 340)">
    <rect x="0" y="0" width="740" height="50" rx="6" fill="#f3f4f6" stroke="#e5e7eb"/>
    <text x="20" y="30" font-size="11" fill="#374151" font-weight="bold">Legend:</text>

    <rect x="90" y="15" width="20" height="20" rx="4" fill="url(#routerGrad)"/>
    <text x="120" y="30" font-size="10" fill="#374151">Router (Intent Classification)</text>

    <rect x="280" y="15" width="20" height="20" rx="4" fill="url(#plannerGrad)"/>
    <text x="310" y="30" font-size="10" fill="#374151">Planner (Strategy)</text>

    <rect x="430" y="15" width="20" height="20" rx="4" fill="url(#executorGrad)"/>
    <text x="460" y="30" font-size="10" fill="#374151">Executor (Tactics)</text>

    <rect x="580" y="15" width="20" height="20" rx="4" fill="url(#reporterGrad)"/>
    <text x="610" y="30" font-size="10" fill="#374151">Reporter (Synthesis)</text>
  </g>
</svg>
